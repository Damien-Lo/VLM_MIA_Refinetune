/local/scratch/clo37/anaconda3/envs/vlm_large_mia_llava_venv/lib/python3.10/site-packages/hydra/_internal/defaults_list.py:251: UserWarning: In 'run_img': Defaults list is missing `_self_`. See https://hydra.cc/docs/1.2/upgrades/1.0_to_1.1/default_composition_order for more information
  warnings.warn(msg, UserWarning)
/home/clo37/.local/lib/python3.10/site-packages/huggingface_hub/file_download.py:943: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
You are using a model of type llava to instantiate a model of type llava_llama. This is not supported for all configurations of models and can yield errors.

          
 

          ==================================================
                            STARTING RUN 
          ==================================================
          
 

          

          
 

          ==================================================
                        !!THIS IS A TEST RUN!!
          ==================================================
          
 

          
Only Running on first 5 batches
Full Config Paramters:
{'data': {'dataset': 'JaineLi/VL-MIA-image', 'subset': 'img_dalle', 'split': 'train', 'augmentations': {'RandomResize': {'use': False, 'size': [[256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256]], 'scale': [[0.2, 0.2], [0.4, 0.4], [0.6, 0.6], [0.8, 0.8], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0]], 'ratio': [[1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [0.5, 0.5], [0.75, 0.75], [1.0, 1.0], [1.25, 1.25], [1.5, 1.5]]}, 'RandomRotation': {'use': False, 'degrees': [0.1, 0.2, 0.3, 0.4, 0.5, 5, 30, 45, 60, 90]}, 'RandomAffine': {'use': False, 'degrees': [30], 'translate': [[0.1, 0.1]], 'scale': [[0.75, 1.25]]}, 'ColorJitter': {'use': False, 'brightness': [0.5], 'contrast': [0.5], 'saturation': [0.5], 'hue': [0.5]}, 'GaussianNoise': {'use': True, 'mean': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'std': [0.01, 0.025, 0.05, 0.075, 0.1, 0.25, 0.5, 0.75]}}}, 'target_model': {'model_path': 'liuhaotian/llava-v1.5-7b', 'model_base': None, 'conv_mode': 'llava_v1', 'gpu_id': 0}, 'reference_model': {'model_path': 'liuhaotian/llava-v1.5-7b', 'model_base': 'llava-v1.5-7b', 'conv_mode': 'llava_v1'}, 'generation': {'use_augmentation': False, 'batch_size': 8, 'num_gen_tokens': 32}, 'inference': {'use_augmentation': True, 'batch_size': 8, 'test_number_of_batches': 5}, 'img_metrics': {'aug_kld': {'name': 'aug_kl_divs'}, 'max_k_renyi_1_entro': {'name': 'max_k_renyi_1_ratio', 'suffix': 'renyi_1', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'max_k_renyi_2_entro': {'name': 'max_k_renyi_2_ratio', 'alpha': 2, 'suffix': 'renyi_2', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'max_k_renyi_05_entro': {'name': 'max_k_renyi_05_ratio', 'alpha': 0.5, 'suffix': 'renyi_05', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'max_prob_gap': {'name': 'max_prob_gap'}, 'min_k_renyi_1_entro': {'name': 'min_k_renyi_1_ratio', 'suffix': 'renyi_1', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'min_k_renyi_2_entro': {'name': 'min_k_renyi_2_ratio', 'alpha': 2, 'suffix': 'renyi_2', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'min_k_renyi_05_entro': {'name': 'min_k_renyi_05_ratio', 'alpha': 0.5, 'suffix': 'renyi_05', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'mink': {'name': 'mink', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'mod_renyi_1_entro': {'name': 'modified_entropy'}, 'mod_renyi_2_entro': {'name': 'modified_renyi_2', 'alpha': 2}, 'mod_renyi_05_entro': {'name': 'modified_reny_0.5', 'alpha': 0.5}, 'renyi_1': {'name': 'renyi_1'}, 'renyi_2': {'name': 'renyi_2', 'alpha': 2}, 'renyi_05': {'name': 'renyi_0.5', 'alpha': 2}, 'renyi_05_full': {'name': 'renyi_05_full'}, 'cross_entropy_mink': {'name': 'cross_entropy_mink', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9]}, 'min_k_renyi_05_kl_div': {'name': 'min_k_renyi_05_kl_div', 'alpha': 0.5, 'suffix': 'renyi_05', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max', 'none'], 'augmentation_setting_version_accumilator': ['avg', 'max', 'none']}, 'min_k_renyi_1_kl_div': {'name': 'min_k_renyi_05_kl_div', 'alpha': 1, 'suffix': 'renyi_1', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max', 'none'], 'augmentation_setting_version_accumilator': ['avg', 'max', 'none']}, 'min_k_renyi_2_kl_div': {'name': 'min_k_renyi_05_kl_div', 'alpha': 2, 'suffix': 'renyi_2', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max', 'none'], 'augmentation_setting_version_accumilator': ['avg', 'max', 'none']}, 'min_k_renyi_inf_kl_div': {'name': 'min_k_renyi_inf_kl_div', 'suffix': 'renyi_inf', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max', 'none'], 'augmentation_setting_version_accumilator': ['avg', 'max', 'none']}, 'min_k_renyi_divergence_025': {'name': 'min_k_renyi_divergence_025', 'alpha': 0.25, 'suffix': 'renyi_025', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max', 'none'], 'augmentation_setting_version_accumilator': ['avg', 'max', 'none']}, 'min_k_renyi_divergence_05': {'name': 'min_k_renyi_divergence_05', 'alpha': 0.5, 'suffix': 'renyi_05', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max', 'none'], 'augmentation_setting_version_accumilator': ['avg', 'max', 'none']}, 'min_k_renyi_divergence_2': {'name': 'min_k_renyi_divergence_2', 'alpha': 2, 'suffix': 'renyi_2', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max', 'none'], 'augmentation_setting_version_accumilator': ['avg', 'max', 'none']}, 'min_k_renyi_divergence_4': {'name': 'min_k_renyi_divergence_4', 'alpha': 4, 'suffix': 'renyi_4', 'ratio': [0, 0.05, 0.1, 0.2, 0.3, 0.4, 0.5, 0.6, 0.7, 0.8, 0.9], 'augmentation_accumilator': ['avg', 'max', 'none'], 'augmentation_setting_version_accumilator': ['avg', 'max', 'none']}, 'metrics_to_use': ['min_k_renyi_05_kl_div', 'min_k_renyi_1_kl_div', 'min_k_renyi_2_kl_div', 'min_k_renyi_inf_kl_div', 'min_k_renyi_divergence_025', 'min_k_renyi_divergence_05', 'min_k_renyi_divergence_2', 'min_k_renyi_divergence_4'], 'parts': ['img'], 'get_token_labels': 1000, 'get_raw_images': 5, 'get_raw_meta_examples': 1000, 'get_raw_meta_metrics': ['ppl', 'losses'], 'get_proc_meta_examples': 1000, 'get_proc_meta_metrics': ['min_k_renyi_05_kl_div_tkn_vals', 'min_k_renyi_1_kl_div_tkn_vals', 'min_k_renyi_2_kl_div_tkn_vals', 'min_k_renyi_inf_kl_div_tkn_vals', 'min_k_renyi_divergence_025_tkn_vals', 'min_k_renyi_divergence_05_tkn_vals', 'min_k_renyi_divergence_4_tkn_vals']}, 'prompt': {'text': 'Describe this image concisely.'}, 'path': {'cache_dir': '/local/scratch/clo37/cache', 'output_dir': '/home/clo37/priv/VLM-MIA-Study/results/TEST_MIA1'}, 'wandb': {'project': 'vlm_mia', 'name': 'run_001', 'mode': 'enabled'}, 'test_run': {'test_run': True}}


AUGMENTATIONS USED:
{'RandomResize': {'use': False, 'size': [[256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256], [256, 256]], 'scale': [[0.2, 0.2], [0.4, 0.4], [0.6, 0.6], [0.8, 0.8], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0]], 'ratio': [[1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [1.0, 1.0], [0.5, 0.5], [0.75, 0.75], [1.0, 1.0], [1.25, 1.25], [1.5, 1.5]]}, 'RandomRotation': {'use': False, 'degrees': [0.1, 0.2, 0.3, 0.4, 0.5, 5, 30, 45, 60, 90]}, 'RandomAffine': {'use': False, 'degrees': [30], 'translate': [[0.1, 0.1]], 'scale': [[0.75, 1.25]]}, 'ColorJitter': {'use': False, 'brightness': [0.5], 'contrast': [0.5], 'saturation': [0.5], 'hue': [0.5]}, 'GaussianNoise': {'use': True, 'mean': [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0], 'std': [0.01, 0.025, 0.05, 0.075, 0.1, 0.25, 0.5, 0.75]}}

REQUESTED DATA
Requested token labels of first 1000 of each class
Requested Raw Augmented Images of first 5 of each class
Requested metrics: ['ppl', 'losses'] of first 1000 of each class
Requested metrics: ['min_k_renyi_05_kl_div_tkn_vals', 'min_k_renyi_1_kl_div_tkn_vals', 'min_k_renyi_2_kl_div_tkn_vals', 'min_k_renyi_inf_kl_div_tkn_vals', 'min_k_renyi_divergence_025_tkn_vals', 'min_k_renyi_divergence_05_tkn_vals', 'min_k_renyi_divergence_4_tkn_vals'] of first 1000 of each class

          
 

          ==================================================
                            LOADING MODEL
          ==================================================
          
Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]/local/scratch/clo37/anaconda3/envs/vlm_large_mia_llava_venv/lib/python3.10/site-packages/torch/_utils.py:831: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  return self.fget.__get__(instance, owner)()
Loading checkpoint shards:  50%|█████     | 1/2 [00:00<00:00,  6.20it/s]Loading checkpoint shards: 100%|██████████| 2/2 [00:00<00:00,  7.70it/s]

          
 

          ==================================================
                            PREPARING DATA
          ==================================================
          
 

          
Generating Inference and Augmentations.....
Data split img_dalle length: 592
Raw Image Indecies: [0 1 2 3 4 5 6 7 8 9]
Map:   0%|          | 0/592 [00:00<?, ? examples/s]Map: 100%|██████████| 592/592 [10:21<00:00,  1.05s/ examples]Map: 100%|██████████| 592/592 [10:28<00:00,  1.06s/ examples]
Appended Desired Sample
Appended Desired Sample
Appended Desired Sample
Appended Desired Sample
Appended Desired Sample
Appended Desired Sample
Appended Desired Sample
Appended Desired Sample
Appended Desired Sample
Appended Desired Sample
Completed. Tokens Acquired
Raw Meta values sampled Indecies: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39]
Processed Meta values sampled Indecies: [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23
 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39]

          
 

          ==================================================
                    SAVING RAW IMAGES TENSORS.....
          ==================================================
          
 

          
Saved orig_image_tensors to /home/clo37/priv/VLM-MIA-Study/results/TEST_MIA1/orig_image_tensors.pt
Saved aug_image_tensors to /home/clo37/priv/VLM-MIA-Study/results/TEST_MIA1/aug_image_tensors.pt
RAW IMAGE SAVE COMPLETE
Saved image_sampled_indicies to /home/clo37/priv/VLM-MIA-Study/results/TEST_MIA1/image_sampled_indicies.json

          
 

          ==================================================
                        BEGINNING INFERENCE
          ==================================================
          
 

          
Proc Meta Sample Map: defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7], 1: [0, 1, 2, 3, 4, 5, 6, 7], 2: [0, 1, 2, 3, 4, 5, 6, 7], 3: [0, 1, 2, 3, 4, 5, 6, 7], 4: [0, 1, 2, 3, 4, 5, 6, 7]})
Raw Meta Sample Map: defaultdict(<class 'list'>, {0: [0, 1, 2, 3, 4, 5, 6, 7], 1: [0, 1, 2, 3, 4, 5, 6, 7], 2: [0, 1, 2, 3, 4, 5, 6, 7], 3: [0, 1, 2, 3, 4, 5, 6, 7], 4: [0, 1, 2, 3, 4, 5, 6, 7]})
Running inference:   0%|          | 0/74 [00:00<?, ?batch/s]